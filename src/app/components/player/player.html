<footer class="player" *ngIf="currentTrackWithArtists$ | async as track">
  <div class="player-track">
    <img [src]="track.img" alt="Now playing cover">
    <div class="track-meta">
      <div class="track-title" (click)="openInfo()">{{ track.name }}</div>
      <div class="track-artist">{{ track.artistNames }}</div>
    </div>
  </div>

  <div class="player-center">
    <div class="player-controls">
      <button type="button" class="ghost" [class.active]="isShuffleActive()" aria-label="Shuffle" (click)="toggleShuffle()">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M17 3h4v4h-2V6.41l-4.29 4.3-1.42-1.42 4.3-4.29H17V3zM7 4h3l4 4-1.41 1.42L9.17 6H7a2 2 0 0 0-2 2v2H3V8a4 4 0 0 1 4-4zm10 17h4v-4h-2v1.59l-4.29-4.3-1.42 1.42 4.3 4.29H17V21zM7 20a4 4 0 0 1-4-4v-2h2v2a2 2 0 0 0 2 2h3l3.59-3.59L15 16l-4 4H7z"/>
        </svg>
      </button>
      <button type="button" aria-label="Previous track" (click)="prevTrack()">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M6 5h2v14H6zM20 6v12l-10-6 10-6z"/>
        </svg>
      </button>
      <label class="play-toggle" aria-label="Play or pause">
        <input
          type="checkbox"
          [checked]="(isPlaying$ | async) ?? false"
          (change)="togglePlay()"
        >
        <svg viewBox="0 0 24 24" aria-hidden="true" class="play">
          <path d="M7 5v14l11-7z"></path>
        </svg>
        <svg viewBox="0 0 24 24" aria-hidden="true" class="pause">
          <path d="M6 5h4v14H6zM14 5h4v14h-4z"></path>
        </svg>
      </label>
      <button type="button" aria-label="Next track" (click)="nextTrack()">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M16 5h2v14h-2zM4 6l10 6-10 6V6z"/>
        </svg>
      </button>
      <button type="button" class="ghost" [class.active]="isRepeatActive()" aria-label="Repeat" (click)="toggleRepeatMode()">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M7 7h9v3l4-4-4-4v3H6a4 4 0 0 0-4 4v3h2V9a2 2 0 0 1 2-2zm10 10H8v-3l-4 4 4 4v-3h10a4 4 0 0 0 4-4v-3h-2v3a2 2 0 0 1-2 2z"/>
        </svg>
      </button>
    </div>
    <div class="player-progress">
      <span>{{ ((currentTime$ | async) ?? 0) | duration }}</span>
      <input
        type="range"
        min="0"
        ... step="0.01"
        [max]="(duration$ | async) ?? 0"
        [value]="(currentTime$ | async) ?? 0"
        (input)="seek($any($event.target).value)"
        aria-label="Track progress"
      >
      <span>{{ ((duration$ | async) ?? 0) | duration }}</span>
    </div>
  </div>

  <div class="player-extra">
    <button class="setting-btn">
      <span class="bar bar1"></span>
      <span class="bar bar2"></span>
      <span class="bar bar1"></span>
    </button>
    <input
      type="range"
      min="0"
      max="1"
      step="0.01"
      [value]="(volume$ | async) ?? 0.7"
      (input)="setVolume($any($event.target).value)"
      aria-label="Volume"
    >
  </div>
</footer>
